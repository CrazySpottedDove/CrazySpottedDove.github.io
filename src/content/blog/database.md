---
title: 数据库
description: 数据库笔记
pubDate: 2025-02-17
updatedDate: 2025-02-17
tags: ["database"]
category: "课程笔记"
---
## Introduction

### 测试与评分

- 作业 10%
- 小测 10%
- 实验 30%
- 期末考 50%

期末考允许带一张 A4 纸。

### 传统数据库生态的四种角色

- DBMS 开发者：高水平计算机专家，开发标准化、产品化的数据库管理系统
- 系统集成商：普通编程人员，基于 DBMS 开发各类信息化应用系统
- 数据库管理员 DBA：运维人员，使用运维工具维护数据库管理系统
- 最终用户：业务专家，在各类业务场景中使用系统。

### 模型

- 对数据语义的抽象产生了关系数据模型
- 对业务逻辑的抽象产生了事务处理模型

数据库的三大成就是：关系模型、事务处理、查询优化。

### 什么是数据库系统

*数据库*是长期存储在计算机内的、大规模的、相互联系的、可共享的数据集合。

*数据库管理系统*(DBMS) 是数据库 + 用于管理数据库的程序。

> 有时我们会直接把数据库管理系统说成数据库。

### 学习什么

- 数据库的建模和设计——从现实中抽象
- 编程——使用数据库，学会 SQL 语言
- 实现 DBMS —— DBMS 如何工作、设计

### DBMS 的特征

- 数据管理的效率和可拓展性(scalability)
- 减小开发时间
- 数据独立性
- 数据完整性(integrity)与安全性
- 并发访问(concurrent access)和鲁棒性(robustness)

> 鲁棒性：稳健性、健壮性

### 文件系统的问题

在数据库系统出现之前，已经有了文件系统。然而，文件系统具有如下问题：

- 数据冗余(redundancy)和不一致(inconsistency)——文件格式非常多
- 访问数据困难——需要用新的程序来执行新的任务
- 数据隔离(isolation)——不同文件和不同格式，难以检索(retrieve)和分享
- 完整性约束还需要程序来完成，难以添加和修改约束
- 更新没有原子性(atomicity)
- 不容易被多个用户并发访问
- 安全问题

> 原子性：一个事务中的所有操作要么全部成功，要么全部失败回滚，不会结束在中间某个环节

这些问题可以借助数据库来解决。

### 数据的抽象等级

不同对数据库的使用方法需要不同等级的抽象。

- Physical Level: 描述一个 record 如何被存储
- Logical Level: 描述存储在数据库中的数据以及这些数据之间更高级的关系
- View Level: 通过应用程序来显示某些数据的细节（可能隐藏一些细节）

#### 物理层的独立性

物理层实现的改变，不影响上层对它的使用。

> DBMS 最重要的优势之一

#### 逻辑层的独立性

数据库的逻辑结构发生变化时，应用程序无需修改。

> 这个较难实现

### DB 语言

- 数据定义语言(DDL)：指明结构
- **数据操纵语言(DML)**：增删改查。

> M: Manipulation

- 数据控制语言(DCL)：安全性相关。

SQL = DDL + DML + DCL

## 关系模型 Relational Model

### 六大基本操作

在关系代数中，有六个基本操作：

- 选择 Select，把表中符合某些条件的数据找出来，形成一个新的表。

> 记作 $\sigma_{p}(r)$，此处 $p$ 为筛选条件， $r$ 为表格。

- 投影 Project，它是一种纵向操作，提取一张表中的某些属性形成一个新的表，并合并其中重复的行。

> 记作 $\Pi_{array}(r)$，$array$ 是一个属性数组。

- 并 Union，合并两张拥有相同属性名的表，并合并其中重复的行。
- 集合差 Set Difference，在原表中去掉另一张表中已存在的行。
- 笛卡尔积 Cartesian product，对两个拥有不同属性的表操作，返回由各自的行的全部自由组合 collect 成的新表。
- 重命名 Rename，重命名一张表里的属性名字。

所有其它操作都可以表示成这六个基本操作的组合。

例如交操作，就可以表示成 $r∩s=r-(r-s)$，即用两次集合差实现。

### 四大常见操作

- 交 Set Intersection，提取两张表中相同的行。
- 自然连接 Natural join，连接两张表，保留其中公共属性相等的行。

> 首先对两张表做笛卡尔积，然后选择其中各对公共属性相等的行，最后用投影除去其中重复的公共属性
>
> theta 连接:先做笛卡尔积，然后做条件为 $\theta$ 的选择.

- 除 Division，首先舍弃除数表中所有被除数表不拥有的属性，然后返回一张最大的表，使得它与作为除数的表的笛卡尔积是被除的表的子集。
- 赋值 Assignment，把一个运算的结果赋给临时变量。

### 拓展操作

- 广义投影 Generalized Projection，允许把投影的属性数组替换成属性函数数组
- 聚合操作 Aggregate Functions and Operations，实现取平均、最大值、最小值、求和、计数。

### 数据库的修改

无非就是增删改的操作，我们用符号来表达它们。

- Deletion $A \leftarrow A-\sigma_{a=sth}(A)$
- Insertion $A \leftarrow A ∪ {(element_1,...element_n)}$
- Update $A \leftarrow \Pi_{f(a_1),f(a_2),...f(a_n)}$
